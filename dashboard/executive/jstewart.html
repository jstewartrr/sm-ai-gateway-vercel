<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Executive Dashboard | ABBI</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><style>:root{--primary:#0f172a;--secondary:#1e293b;--accent:#3b82f6;--accent-light:#60a5fa;--success:#10b981;--warning:#f59e0b;--danger:#ef4444;--text:#f8fafc;--text-muted:#94a3b8;--border:#334155;--card-bg:rgba(30,41,59,0.8)}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#0f172a 0%,#1e1b4b 50%,#0f172a 100%);min-height:100vh;color:var(--text);padding:20px}.dashboard{max-width:1600px;margin:0 auto}.login-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#0f172a 0%,#1e1b4b 50%,#0f172a 100%);display:flex;align-items:center;justify-content:center;z-index:9999}.login-overlay.hidden{display:none}.login-card{background:var(--card-bg);backdrop-filter:blur(10px);border:1px solid var(--border);border-radius:20px;padding:40px;text-align:center;max-width:400px;width:90%}.login-logo{width:80px;height:80px;background:linear-gradient(135deg,var(--accent) 0%,#8b5cf6 100%);border-radius:20px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:32px;margin:0 auto 24px}.login-title{font-size:1.5rem;font-weight:600;margin-bottom:8px}.login-subtitle{color:var(--text-muted);font-size:.9rem;margin-bottom:24px}.login-input{width:100%;padding:14px;background:var(--primary);border:1px solid var(--border);border-radius:10px;color:var(--text);font-size:1rem;margin-bottom:16px}.login-input:focus{outline:none;border-color:var(--accent)}.login-error{color:var(--danger);font-size:.85rem;margin-bottom:16px;display:none}.login-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--accent) 0%,#8b5cf6 100%);border:none;border-radius:10px;color:white;font-size:1rem;font-weight:600;cursor:pointer}.report-banner{background:linear-gradient(135deg,rgba(59,130,246,0.2) 0%,rgba(139,92,246,0.2) 100%);border:1px solid var(--accent);border-radius:12px;padding:16px 24px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px}.report-info{display:flex;align-items:center;gap:15px}.report-icon{width:40px;height:40px;background:var(--accent);border-radius:10px;display:flex;align-items:center;justify-content:center}.report-timestamp{font-size:14px;color:var(--text-muted)}.report-timestamp strong{color:var(--text)}.generate-btn{background:linear-gradient(135deg,var(--accent) 0%,#8b5cf6 100%);color:white;border:none;padding:14px 28px;border-radius:10px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:10px;box-shadow:0 4px 15px rgba(59,130,246,0.3)}.generate-btn:hover{transform:translateY(-2px)}.generate-btn:disabled{opacity:0.7}.modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:1000;align-items:center;justify-content:center}.modal-overlay.active{display:flex}.modal{background:var(--secondary);border:1px solid var(--border);border-radius:20px;padding:30px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.modal-title{font-size:20px;font-weight:600;display:flex;align-items:center;gap:10px}.modal-close{background:none;border:none;color:var(--text-muted);font-size:24px;cursor:pointer}.progress-step{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--border)}.step-icon{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center}.step-icon.pending{background:var(--border);color:var(--text-muted)}.step-icon.active{background:var(--accent);color:white;animation:pulse 1.5s infinite}.step-icon.complete{background:var(--success);color:white}.step-icon.error{background:var(--danger);color:white}.step-status{font-size:12px;color:var(--text-muted)}.report-output{background:var(--primary);border-radius:10px;padding:15px;font-family:monospace;font-size:13px;max-height:300px;overflow-y:auto;white-space:pre-wrap;display:none}.report-output.visible{display:block}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:20px;background:var(--card-bg);border-radius:16px;border:1px solid var(--border);flex-wrap:wrap;gap:15px}.header-left{display:flex;align-items:center;gap:20px}.logo{width:50px;height:50px;background:linear-gradient(135deg,var(--accent) 0%,#8b5cf6 100%);border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px}.header-title h1{font-size:24px;font-weight:600}.header-title p{color:var(--text-muted);font-size:14px}.date-display{font-size:24px;font-weight:600;color:var(--accent-light)}.time-display{color:var(--text-muted);font-size:14px}.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:20px}.card{background:var(--card-bg);border-radius:16px;border:1px solid var(--border);padding:24px}.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:1px solid var(--border)}.card-title{display:flex;align-items:center;gap:10px;font-weight:600}.card-title i{color:var(--accent)}.card-badge{background:var(--accent);color:white;padding:4px 12px;border-radius:20px;font-size:12px}.card-badge.warning{background:var(--warning)}.card-badge.danger{background:var(--danger)}.calendar-section{grid-column:span 8}.calendar-event{display:flex;align-items:center;padding:16px;background:rgba(59,130,246,0.1);border-radius:12px;margin-bottom:12px;border-left:4px solid var(--accent)}.event-time{min-width:100px;font-weight:600;color:var(--accent-light)}.event-title{font-weight:500}.event-meta{font-size:13px;color:var(--text-muted)}.event-type{padding:4px 10px;border-radius:6px;font-size:11px;text-transform:uppercase}.event-type.meeting{background:rgba(59,130,246,0.2);color:var(--accent-light)}.event-type.desk{background:rgba(16,185,129,0.2);color:var(--success)}.event-type.personal{background:rgba(139,92,246,0.2);color:#a78bfa}.stats-section{grid-column:span 4}.stat-card{background:rgba(59,130,246,0.1);border-radius:12px;padding:20px;margin-bottom:15px;text-align:center}.stat-value{font-size:36px;font-weight:700;color:var(--accent-light)}.stat-value.danger{color:var(--danger)}.stat-value.success{color:var(--success)}.stat-label{color:var(--text-muted);font-size:13px}.email-section{grid-column:span 6}.email-item{display:flex;padding:16px;background:rgba(255,255,255,0.03);border-radius:12px;margin-bottom:12px;cursor:pointer}.email-item:hover{background:rgba(255,255,255,0.06)}.email-priority{width:8px;height:8px;border-radius:50%;margin-right:15px;margin-top:6px}.email-priority.high{background:var(--danger)}.email-priority.medium{background:var(--warning)}.email-from{font-weight:500}.email-subject{color:var(--text-muted);font-size:14px}.email-time{font-size:12px;color:var(--text-muted)}.tasks-section{grid-column:span 6}.task-item{display:flex;align-items:center;padding:14px;background:rgba(239,68,68,0.1);border-radius:12px;margin-bottom:10px;border-left:4px solid var(--danger);cursor:pointer}.task-item:hover{background:rgba(239,68,68,0.15)}.task-icon{width:32px;height:32px;background:rgba(239,68,68,0.2);border-radius:8px;display:flex;align-items:center;justify-content:center;margin-right:15px;color:var(--danger)}.task-name{font-weight:500;font-size:14px}.task-due{font-size:12px;color:var(--danger)}.activity-section{grid-column:span 12}.activity-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px}.activity-item{padding:20px;background:rgba(255,255,255,0.03);border-radius:12px}.activity-type{font-size:11px;text-transform:uppercase;color:var(--accent);font-weight:600;margin-bottom:8px}.activity-title{font-weight:500;margin-bottom:6px}.activity-desc{font-size:13px;color:var(--text-muted)}.loading{display:flex;align-items:center;justify-content:center;padding:40px;color:var(--text-muted)}.spinner{width:30px;height:30px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin-right:15px}@keyframes spin{to{transform:rotate(360deg)}}.refresh-btn{background:var(--secondary);color:white;border:1px solid var(--border);padding:10px 20px;border-radius:8px;cursor:pointer;display:flex;align-items:center;gap:8px}.refresh-btn:hover{background:var(--border)}.status-indicator{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:8px}.status-indicator.live{background:var(--success)}.status-indicator.error{background:var(--danger)}.footer{text-align:center;padding:30px;color:var(--text-muted);font-size:13px}.footer a{color:var(--accent)}.empty-state{text-align:center;padding:30px;color:var(--text-muted)}@media(max-width:1200px){.calendar-section,.stats-section,.email-section,.tasks-section{grid-column:span 12}.activity-grid{grid-template-columns:1fr}}</style></head><body><div class="login-overlay" id="loginOverlay"><div class="login-card"><div class="login-logo">A</div><div class="login-title">Executive Dashboard</div><div class="login-subtitle">Enter your access token</div><input type="password" id="tokenInput" class="login-input" placeholder="Access Token" onkeypress="if(event.key==='Enter')attemptLogin()"><p class="login-error" id="loginError">Invalid token</p><button class="login-btn" onclick="attemptLogin()">Access Dashboard</button></div></div><div class="dashboard" id="mainDashboard" style="display:none"><div class="report-banner"><div class="report-info"><div class="report-icon"><i class="fas fa-file-alt"></i></div><div><div class="report-timestamp"><strong>Last Report:</strong> <span id="reportTimestamp">Never</span></div><div class="report-timestamp">Data: <span id="dataTimestamp">--</span></div></div></div><button class="generate-btn" id="generateBtn" onclick="generateReport()"><i class="fas fa-magic"></i> Generate Report</button></div><header class="header"><div class="header-left"><div class="logo">A</div><div class="header-title"><h1>Executive Dashboard</h1><p id="greeting">Good morning, Your Grace</p></div></div><div class="header-right"><div class="date-display" id="currentDate">Loading...</div><div class="time-display" id="currentTime">--:--</div><button class="refresh-btn" id="refreshBtn" onclick="refreshDashboard()"><i class="fas fa-sync-alt"></i> Refresh</button><button class="refresh-btn" onclick="logout()" style="margin-top:8px"><i class="fas fa-sign-out-alt"></i> Logout</button></div></header><div class="grid"><div class="card calendar-section"><div class="card-header"><div class="card-title"><i class="fas fa-calendar-alt"></i> Today's Schedule</div><span class="card-badge" id="eventCount">0</span></div><div id="calendarEvents"><div class="loading"><div class="spinner"></div>Loading...</div></div></div><div class="card stats-section"><div class="card-header"><div class="card-title"><i class="fas fa-chart-bar"></i> Stats</div></div><div class="stat-card"><div class="stat-value danger" id="overdueCount">--</div><div class="stat-label">Overdue</div></div><div class="stat-card"><div class="stat-value" id="unreadCount">--</div><div class="stat-label">Emails</div></div><div class="stat-card"><div class="stat-value success" id="meetingCount">--</div><div class="stat-label">Meetings</div></div></div><div class="card email-section"><div class="card-header"><div class="card-title"><i class="fas fa-envelope"></i> Priority Emails</div><span class="card-badge warning">Action</span></div><div id="emailList"><div class="loading"><div class="spinner"></div>Loading...</div></div></div><div class="card tasks-section"><div class="card-header"><div class="card-title"><i class="fas fa-exclamation-triangle"></i> Overdue Tasks</div><span class="card-badge danger">Attention</span></div><div id="taskList"><div class="loading"><div class="spinner"></div>Loading...</div></div></div><div class="card activity-section"><div class="card-header"><div class="card-title"><i class="fas fa-brain"></i> Hive Mind</div><span id="apiStatus"><span class="status-indicator live"></span>Live</span></div><div class="activity-grid" id="activityGrid"><div class="loading" style="grid-column:span 3"><div class="spinner"></div>Loading...</div></div></div></div><footer class="footer">Powered by <a href="https://abbi-ai.com">ABBI</a></footer></div><div class="modal-overlay" id="progressModal"><div class="modal"><div class="modal-header"><div class="modal-title"><i class="fas fa-cog fa-spin" id="modalIcon"></i><span id="modalTitle">Generating...</span></div><button class="modal-close" onclick="closeModal()">&times;</button></div><div id="progressSteps"><div class="progress-step" data-step="email"><div class="step-icon pending"><i class="fas fa-envelope"></i></div><div>Processing Emails</div><div class="step-status" id="emailStatus">Waiting</div></div><div class="progress-step" data-step="calendar"><div class="step-icon pending"><i class="fas fa-calendar"></i></div><div>Calendar</div><div class="step-status" id="calendarStatus">Waiting</div></div><div class="progress-step" data-step="asana"><div class="step-icon pending"><i class="fas fa-tasks"></i></div><div>Asana</div><div class="step-status" id="asanaStatus">Waiting</div></div><div class="progress-step" data-step="hive"><div class="step-icon pending"><i class="fas fa-database"></i></div><div>Hive Mind</div><div class="step-status" id="hiveStatus">Waiting</div></div></div><div class="report-output" id="reportOutput"></div></div></div><script>const TK='SM-c22da6c5433fc0c4a1a11e5d8b6e1082';function checkAuth(){if(localStorage.getItem('sm_token')===TK)showDashboard()}function attemptLogin(){const t=document.getElementById('tokenInput').value.trim();if(t===TK){localStorage.setItem('sm_token',t);showDashboard()}else{document.getElementById('loginError').style.display='block'}}function showDashboard(){document.getElementById('loginOverlay').classList.add('hidden');document.getElementById('mainDashboard').style.display='block';refreshDashboard()}function logout(){localStorage.removeItem('sm_token');location.reload()}checkAuth();const API='/api/executive/jstewart',GEN='/api/executive/generate-report';let isR=false,isG=false;const sv=localStorage.getItem('lastReport');if(sv)document.getElementById('reportTimestamp').textContent=sv;function upDT(){const n=new Date();document.getElementById('currentDate').textContent=n.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'});document.getElementById('currentTime').textContent=n.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});document.getElementById('greeting').textContent=(n.getHours()<12?'Good morning':n.getHours()<17?'Good afternoon':'Good evening')+', Your Grace'}setInterval(upDT,1000);upDT();async function generateReport(){if(isG)return;isG=true;const b=document.getElementById('generateBtn');b.disabled=true;b.innerHTML='<i class="fas fa-spinner fa-spin"></i> Working...';document.getElementById('progressModal').classList.add('active');document.getElementById('reportOutput').classList.remove('visible');document.querySelectorAll('.step-icon').forEach(e=>e.className='step-icon pending');const st=['email','calendar','asana','hive'];let c=0;const iv=setInterval(()=>{if(c<st.length){document.querySelector('[data-step="'+st[c]+'"] .step-icon').className='step-icon active';if(c>0)document.querySelector('[data-step="'+st[c-1]+'"] .step-icon').className='step-icon complete';c++}},2000);try{const r=await fetch(GEN,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:'jstewart'})});const d=await r.json();clearInterval(iv);document.querySelectorAll('.step-icon').forEach(e=>e.className='step-icon complete');if(d.success){const ts=new Date().toLocaleString('en-US',{month:'short',day:'numeric',hour:'numeric',minute:'2-digit'});document.getElementById('reportTimestamp').textContent=ts;localStorage.setItem('lastReport',ts);document.getElementById('modalIcon').className='fas fa-check-circle';document.getElementById('modalIcon').style.color='var(--success)';document.getElementById('modalTitle').textContent='Done';document.getElementById('reportOutput').textContent=d.report||'Complete';document.getElementById('reportOutput').classList.add('visible');setTimeout(refreshDashboard,1000)}else throw new Error(d.error)}catch(e){clearInterval(iv);document.getElementById('modalIcon').className='fas fa-times';document.getElementById('modalIcon').style.color='var(--danger)';document.getElementById('modalTitle').textContent='Error';document.getElementById('reportOutput').textContent=e.message;document.getElementById('reportOutput').classList.add('visible')}b.disabled=false;b.innerHTML='<i class="fas fa-magic"></i> Generate Report';isG=false}function closeModal(){document.getElementById('progressModal').classList.remove('active')}async function refreshDashboard(){if(isR)return;isR=true;document.getElementById('refreshBtn').innerHTML='<i class="fas fa-sync-alt fa-spin"></i>';try{const r=await fetch(API);const d=await r.json();if(d.success){rCal(d.data.calendar);rEm(d.data.emails);rTsk(d.data.tasks);rAct(d.data.activity);document.getElementById('apiStatus').innerHTML='<span class="status-indicator live"></span>Live'}else throw new Error()}catch{document.getElementById('apiStatus').innerHTML='<span class="status-indicator error"></span>Error';fallback()}document.getElementById('dataTimestamp').textContent=new Date().toLocaleTimeString();document.getElementById('refreshBtn').innerHTML='<i class="fas fa-sync-alt"></i> Refresh';isR=false}function rCal(e){const c=document.getElementById('calendarEvents');if(!e||!e.length){c.innerHTML='<div class="empty-state">No events</div>';document.getElementById('eventCount').textContent='0';document.getElementById('meetingCount').textContent='0';return}document.getElementById('eventCount').textContent=e.length;document.getElementById('meetingCount').textContent=e.filter(x=>x.type==='meeting').length;c.innerHTML=e.map(x=>'<div class="calendar-event"><div class="event-time">'+x.time+'</div><div style="flex:1"><div class="event-title">'+x.title+'</div><div class="event-meta">'+(x.location||'')+'</div></div><span class="event-type '+x.type+'">'+x.type+'</span></div>').join('')}function rEm(e){const c=document.getElementById('emailList');if(!e||!e.length){c.innerHTML='<div class="empty-state">No emails</div>';document.getElementById('unreadCount').textContent='0';return}document.getElementById('unreadCount').textContent=e.length;c.innerHTML=e.map(x=>'<div class="email-item"><div class="email-priority '+x.priority+'"></div><div><div class="email-from">'+x.from+'</div><div class="email-subject">'+x.subject+'</div><div class="email-time">'+x.time+'</div></div></div>').join('')}function rTsk(d){const c=document.getElementById('taskList');const t=d&&d.tasks?d.tasks:[];document.getElementById('overdueCount').textContent=d&&d.overdueCount?d.overdueCount:0;if(!t.length){c.innerHTML='<div class="empty-state">No overdue!</div>';return}c.innerHTML=t.slice(0,6).map(x=>'<div class="task-item" onclick="window.open(\''+x.url+'\',\'_blank\')"><div class="task-icon"><i class="fas fa-clock"></i></div><div><div class="task-name">'+x.name+'</div><div class="task-due">Due: '+x.due+'</div></div></div>').join('')}function rAct(a){const c=document.getElementById('activityGrid');if(!a||!a.length){c.innerHTML='<div class="empty-state" style="grid-column:span 3">No activity</div>';return}c.innerHTML=a.map(x=>'<div class="activity-item"><div class="activity-type">'+x.type+'</div><div class="activity-title">'+x.title+'</div><div class="activity-desc">'+x.desc+'</div></div>').join('')}function fallback(){rCal([{time:'9:00 AM',title:'Desk Time',type:'desk'},{time:'1:00 PM',title:'Meeting',type:'meeting'}]);rEm([{from:'System',subject:'Offline mode',priority:'medium',time:'Now'}]);rTsk({tasks:[],overdueCount:58});rAct([{type:'System',title:'Offline',desc:'API unavailable'}])}if(localStorage.getItem('sm_token')===TK)refreshDashboard();setInterval(function(){if(localStorage.getItem('sm_token')===TK)refreshDashboard()},300000);</script></body></html>